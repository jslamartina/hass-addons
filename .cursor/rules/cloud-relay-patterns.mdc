---
description: Cloud relay mode patterns and limitations
---

# Cloud Relay Mode Patterns

**⚠️ Cloud relay mode is READ-ONLY for monitoring and inspection.**

**Commands from Home Assistant DO NOT work in relay mode** - you'll see `No TCP bridges available!` errors.

**Rule:** Disable relay mode for normal local control.

## When to Enable

✅ **Protocol analysis** - Reverse engineering packet structures
✅ **Debugging device behavior** - Observing cloud communication
✅ **Packet inspection** - Monitor traffic with forwarding to cloud
✅ **Privacy monitoring** - Block cloud access, log attempts

❌ **Normal local control** - Commands don't work!
❌ **Production use** - Read-only limitation
❌ **Daily usage** - Use baseline mode instead

## Configuration Presets

```bash
# Baseline (LAN-only, normal operation)
./scripts/configure-addon.sh preset-baseline

# Relay with cloud forwarding (packet inspection)
./scripts/configure-addon.sh preset-relay-with-forward

# Relay with debug logging (protocol analysis)
./scripts/configure-addon.sh preset-relay-debug

# LAN-only relay (privacy mode, blocks cloud)
./scripts/configure-addon.sh preset-lan-only
```

## Configuration Options

```yaml
cloud_relay:
  enabled: false                      # Enable relay mode
  forward_to_cloud: true              # Forward packets to cloud
  cloud_server: "35.196.85.236"       # Cync cloud IP
  cloud_port: 23779                   # Cync cloud port
  debug_packet_logging: false         # Verbose packet logging
```

**Security Warning:** Never use `disable_ssl_verification: true` in production.

## Switching Modes

```bash
# Enable relay for debugging
./scripts/configure-addon.sh preset-relay-debug

# Monitor logs
ha addons logs local_cync-controller --follow | grep "packet"

# Return to normal mode
./scripts/configure-addon.sh preset-baseline
```

## Operating Modes

**Mode 1: Baseline (Recommended)**
- ✅ Full local control
- ✅ Commands work from Home Assistant
- ❌ No packet inspection

**Mode 2: Relay with Cloud Forwarding**
- ✅ Devices still work (cloud receives packets)
- ✅ Basic packet logging
- ❌ Commands from HA don't work

**Mode 3: LAN-Only with Inspection**
- ✅ Blocks all cloud communication
- ✅ Logs what devices attempt to send
- ❌ Devices lose cloud functionality

## Known Issues

**Commands Don't Work**
- Symptom: Turning on lights in HA has no effect
- Cause: Relay mode is read-only
- Fix: Disable relay mode for normal operation

**Devices Show Offline**
- Cause: Relay doesn't maintain bidirectional TCP connections properly
- Fix: Use relay temporarily, return to baseline for daily use
