---
description: How to access Supervisor API correctly
---

# Supervisor API Access

**Important:** Scripts that need to access the Home Assistant Supervisor API **MUST be run from within the `hassio_cli` container** because the `supervisor` hostname is only resolvable inside supervisor-managed containers.

## Correct Approaches

```bash
# ✅ BEST: Use ha CLI commands directly (automatically runs in hassio_cli)
ha addons info local_cync-controller --raw-json | jq '.data.options'

# ✅ ALTERNATIVE: Run curl inside hassio_cli container
docker exec hassio_cli curl -sf \
  -H "Authorization: Bearer $SUPERVISOR_TOKEN" \
  http://supervisor/addons/local_cync-controller/options
```

## Incorrect Approaches

```bash
# ❌ WRONG - Will fail with "Could not resolve host: supervisor"
./scripts/configure-addon.sh get

# ❌ WRONG - supervisor hostname not reachable from devcontainer
curl http://supervisor/addons/...
```

## Why This Matters

- The devcontainer shell is **outside** the Home Assistant Supervisor network
- The `supervisor` hostname only resolves inside supervisor-managed containers (hassio_cli, hassio_supervisor, add-on containers)
- The `hassio_cli` container **does not** have access to the devcontainer filesystem

## Script Behavior Reference

- `scripts/configure-addon.sh` - Uses direct Supervisor API, requires `SUPERVISOR_TOKEN`
- `scripts/setup-fresh-ha.sh` - Uses `docker exec hassio_cli curl ...` internally
- `scripts/test-cloud-relay.sh` - Works from devcontainer (uses ha CLI)
- `cync-controller/rebuild.sh` - Works from devcontainer (uses ha CLI)

## Recommended Approach

**Use `ha` CLI commands directly** - They automatically run inside hassio_cli and handle authentication. For complex operations, create helper scripts that use `ha` CLI internally instead of direct Supervisor API calls.
