---
description: MQTT entity cleanup workflows and best practices
---

# MQTT Entity Cleanup

**Critical:** MQTT entities CANNOT be deleted while the integration is actively providing them.

**Quick cleanup workflow:**
```bash
sudo python3 scripts/delete-mqtt-safe.py --dry-run  # Preview
sudo python3 scripts/delete-mqtt-safe.py             # Delete
ha addons restart local_cync-controller
```

**Pattern:** Stop integration → Delete entities → Restart integration

**Automated (recommended):**
```bash
sudo python3 scripts/delete-mqtt-safe.py --restart
```

**Manual:**
```bash
ha addons stop local_cync-controller
sleep 30  # Wait for entities to become unavailable
# Then delete via UI: Settings → Devices & Services → Entities
ha addons restart local_cync-controller
```

## When to Use

- Changed `suggested_area` in MQTT discovery
- Changed MQTT discovery payload structure
- Testing entity rediscovery
- Cleaning up test entities

## What Gets Cleaned

The script cleans: entity registry, device registry, restore state. Always preserves Cync Controller bridge device.
