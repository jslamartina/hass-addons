---
globs: scripts/**/*.sh,cync-controller/src/**/*.py
---

# MQTT Integration Notes

- Use Home Assistant MQTT Discovery (`homeassistant/<component>/<node_id>/<object_id>/config`) with exact schema: include `availability`, `stat_t`, `cmd_t`, consistent `suggested_area`.
- After schema updates, remove stale entities (prefer `sudo python3 scripts/delete-mqtt-safe.py [--dry-run]` then restart add-on).
- Validate MQTT broker connectivity + auth before debugging code paths.

Reference: `cync-controller/src/cync_lan/mqtt_client.py`, `docs/user/troubleshooting.md`, `docs/developer/architecture.md`.
